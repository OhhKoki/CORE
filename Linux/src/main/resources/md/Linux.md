## 一、Linux 总体架构

Linux是一个开源的类Unix操作系统，具有高效、稳定和灵活的特点。

Linux 整体架构采用分层设计，分为用户空间和内核空间，两者通过系统调用接口（syscall 指令）交互。

```
+-----------------------------
|        **用户空间**         
|-----------------------------
| 1. 应用程序                 
|   - Shell (Bash/Zsh)        
|   - GUI (GNOME/KDE)         
|   - 服务器软件 (Nginx)      
|                             
| 2. 系统库                   
|   - glibc、libm、pthread    
|                             
| 3. 运行时环境               
|   - JVM、Python 解释器等    
+-----------------------------
              ↓
+-----------------------------
| **系统调用接口**   
| 用户空间与内核空间的沟通桥梁
| 通过syscall命令触发内核模式切换 
+-----------------------------
              ↓
+-----------------------------
|        **内核空间**         
|-----------------------------
| 1. 进程管理                 
|   - 调度器（CFS）           
|   - IPC、Namespaces         
|                             
| 2. 内存管理                 
|   - 虚拟内存、Page Cache    
|   - Buddy/Slab 分配器       
|                             
| 3. 文件系统（VFS）          
|   - ext4/Btrfs/XFS          
|                             
| 4. 设备驱动                 
|   - 字符/块/网络设备        
|                             
| 5. 网络子系统               
|   - TCP/IP、Netfilter       
|                             
| 6. 安全模块（SELinux）      
| 7. 虚拟化支持（KVM）        
| 8. 中断处理                 
+-----------------------------
              ↓
+-----------------------------
|        **硬件层**           
|-----------------------------
| CPU、内存、磁盘、网卡等     
+-----------------------------
```



### 1、用户空间（User Space）

​	用户空间是用户运行应用程序的环境，包含了各种用户级的工具和服务。这个层次包括了标准库（如glibc）、Shell、应用程序等。



- **应用程序**

    - Shell（Bash、Zsh）
    - 图形界面（GNOME、KDE）
    - 服务器软件（Apache、Nginx）

- **系统库**

    - GNU C 库（glibc）
    - 数学库（libm）
    - 线程库（pthread）

- **运行时环境**

    - Java 虚拟机（JVM）

    - Python 解释器

    - C++ 解释器

        

### 2、系统调用接口（Syscall Interface）

​	这是用户程序与内核进行交互的方式，应用程序通过系统调用与内核沟通（通过 syscall 指令触发内核模式切换），执行如文件操作、进程管理等任务。



### 3、内核空间（Kernel Space）

​	Linux内核是操作系统的核心，负责管理硬件资源、进程调度、内存管理、文件系统、网络通信等。内核是系统与硬件之间的接口，直接与硬件交互。



- **进程管理**

    - 进程调度（CFS 调度器）、创建/终止（`fork`, `exec`）、进程间通信（IPC：管道、信号、共享内存等）。
    - 线程管理（轻量级进程）及命名空间（Namespaces）支持容器隔离。

- **内存管理**

    - 虚拟内存管理：分页、地址空间映射（MMU）、页面置换算法（LRU）。
    - 物理内存分配（Buddy 系统）、缓存（Page Cache）及 Slab 分配器。

- **文件系统（VFS 抽象层）**

    - 支持多种文件系统（ext4、Btrfs、XFS），通过虚拟文件系统（VFS）统一接口。
    - 处理文件读写、权限控制及挂载点管理。

- **设备驱动**

    - 管理硬件设备，分三类：字符设备（键盘）、块设备（SSD）、网络设备（网卡）。
    - 通过设备文件（如 `/dev/sda`）和 sysfs 提供用户接口。

- **网络子系统**

    - 实现 TCP/IP、UDP、ICMP 等协议栈，处理数据包路由、过滤（Netfilter）及套接字（Socket）通信。

- **其他子系统**

    - **安全模块**：SELinux、AppArmor 基于 LSM 框架实施强制访问控制。
    - **虚拟化支持**：KVM 模块与硬件虚拟化扩展（Intel VT-x）协作，支持虚拟机监控。
    - **内核模块**：动态加载驱动或功能（如 `ext4.ko`），增强扩展性。

- **中断与异常处理**

    - 响应硬件中断（IRQ）、软件异常（如缺页），确保实时性和稳定性。

- **初始化与启动**

    - 由 Bootloader 加载内核，初始化子系统后挂载根文件系统，启动 systemd（或传统 init）进入用户空间。

        

### 4、硬件层（Hardware）

​	这是Linux系统运行的基础，指的是计算机的硬件资源，如CPU、内存、硬盘、网络设备等，由内核直接管理或通过驱动交互。



## 二、Linux 常用命令

​	在 Linux 系统上常用的命令主要是用于文件管理、系统监控、进程管理、网络配置等方面。以下是 Linux 系统上使用频率较高的 30 个命令，以及它们的常见用法和参数：



### 1. `ls` - 列出目录内容

**参数**：

- `-l`：以长格式显示文件和目录的详细信息。
- `-a`：显示所有文件，包括隐藏文件。
- `-h`：以可读性更高的方式显示文件大小（**文件**大小的单位转为K、M、G）。

**示例**：

```bash
# 列出当前目录下的所有文件（包括隐藏文件）
ls -a

# 列出当前目录下所有的文件，并显示文件和目录的详细信息，并以可读性更高的方式显示文件大小
ls -lha

# 列出 /home/user 目录目录下的文件，并显示文件和目录的详细信息，并以可读性更高的方式显示文件大小
ls -lh /home/user
```



### 2. `cd` - 改变当前目录

**参数**：

- `~`：用户的主目录。
- `..`：上一级目录。

**示例**：

```bash
# 进入 /home/user 目录
cd /home/user

# 进入当前目录下的 document 目录
cd ./document

# 进入当前目录的爷爷级目录
cd ../..
```



### 3. `pwd` - 显示当前工作目录的路径

**参数**：

**示例**：

```bash
# 进入用户的主目录
cd ~

# 显示当前的工作目录的路径：/Users/terry
pwd
```



### 4. `mkdir` - 创建目录

**参数：**

- `-p`：递归创建目录，即创建嵌套目录时自动创建父目录。

**示例：**

```bash
# 创建一个名为 test 的目录
mkdir test

# 递归创建目录 /home/user/documents/newdir
mkdir -p /home/user/documents/newdir
```



### 5. `mv` - 移动或重命名文件

**参数：**

- `-i`：在覆盖现有文件时提示确认。
- `-f`：强制移动文件，不提示确认。

**示例：**

```bash
# 将文件 file1.txt 移动到 /tmp 目录
mv file1.txt /tmp/

# 重命名文件 file1.txt 为 file2.txt
mv file1.txt file2.txt

# 强制移动文件，覆盖已有文件
mv -f file1.txt /tmp/
```



### 6. `cp` - 复制文件或目录

**参数**：

- `-r`：递归复制目录及其内容。
- `-i`：在覆盖现有文件时提示确认。

**示例**：

```bash
# 复制文件 file1.txt 到 /tmp 目录
cp file1.txt /tmp/

# 递归复制目录 dir1 到 /tmp 目录
cp -r dir1 /tmp/
```



### 7. `rm` - 删除文件或目录

**参数：**

- `-r`：递归删除目录及其内容。
- `-f`：强制删除文件或目录，不提示确认。
- `-i`：删除前提示确认。

**示例：**

```bash
# 删除文件 file1.txt
rm file1.txt

# 递归删除目录 dir1 及其内容
rm -r dir1

# 强制删除文件，不提示确认
rm -f file1.txt
```